---
title: "intersection av/res"
author: "Vincyane Badouard"
date: "15/12/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Check intersection between FallenTree and av/res trees
- compute av/res crowns
- compute FallenTrees for all permitted angles
- compute intesections
- remove FallenTree with intersection
- keep only 1 FallenTree


## compute av/res crowns
FutureReserveCrowns

## compute FallenTrees for all permitted angles
```{r}
# directionalfelling == "2", cable case inf fuel !=0
TreefallOrientation <- as.numeric(sample(c(advancedloggingparameters$MinTreefallOrientation: 
                                             advancedloggingparameters$MaxTreefallOrientation), size = 1)) 
# in the other cases
TreefallOrientation <- as.numeric(sample(c(1:179), size = 1))

OppAng <- 180-(90 + TreefallOrientation) # the angle between the closest position to the trail (90Â°) and the desired position (desired angle to the trail)
CrownOppAng <- 180-(90 + CrownTreefallOrientation) # for grapple case

## Right-hand trail
if(TrailPt[1] >= Foot[1]){ # x trail > x foot
  # Foot oriented
  Aangle <- round(as.numeric(180 + OppAng + theta), digits = 0)
  Bangle <- round(as.numeric(180 - OppAng + theta), digits = 0)
  # Crown oriented
  CrownAangle <- as.numeric(theta + CrownOppAng) # ]0;180[ to the trail
  
  ## Left-hand trail
}else if(TrailPt[1] < Foot[1]){ # x trail < x foot
  # Foot oriented
  Aangle <- round(as.numeric(360 - OppAng + theta), digits = 0)
  Bangle <- round(as.numeric(theta + OppAng), digits = 0)
  # Crown oriented
  CrownAangle <- as.numeric(180 + CrownOppAng + theta) # ]0;180[ to the trail
}

Angles

FallenTree <- st_difference(st_union(
  rotatepolygon(Trunk, angle = Angles, fixed = Foot), # turned trunk
  ACrown # turned crown
))
```

## compute intesections
```{r}
FRintersect <- sf::st_intersects(FallenTree, FutureReserveCrowns)
```

## remove FallenTree with intersection
## keep only 1 FallenTree
